{"version":3,"file":"multisig.mjs","sources":["../../../src/utils/multisig.ts"],"sourcesContent":["import { mergeUint8 } from \"@polkadot-api/utils\"\nimport { Binary, compact, u16 } from \"../codecs\"\nimport { Blake2256 } from \"../hashes\"\n\nconst PREFIX = Binary.fromText(\"modlpy/utilisuba\").asBytes()\nexport const getMultisigAccountId = ({\n  threshold,\n  signatories,\n}: {\n  threshold: number\n  signatories: Uint8Array[]\n}) => {\n  const sortedSignatories = sortMultisigSignatories(signatories)\n  const payload = mergeUint8([\n    PREFIX,\n    compact.enc(sortedSignatories.length),\n    ...sortedSignatories,\n    u16.enc(threshold),\n  ])\n  return Blake2256(payload)\n}\n\nexport const sortMultisigSignatories = (signatories: Uint8Array[]) =>\n  signatories.slice().sort((a, b) => {\n    for (let i = 0; ; i++) {\n      const overA = i >= a.length\n      const overB = i >= b.length\n\n      if (overA && overB) return 0\n      else if (overA) return -1\n      else if (overB) return 1\n      else if (a[i] !== b[i]) return a[i] > b[i] ? 1 : -1\n    }\n  })\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAIA,MAAM,MAAS,GAAA,MAAA,CAAO,QAAS,CAAA,kBAAkB,EAAE,OAAQ,EAAA;AACpD,MAAM,uBAAuB,CAAC;AAAA,EACnC,SAAA;AAAA,EACA;AACF,CAGM,KAAA;AACJ,EAAM,MAAA,iBAAA,GAAoB,wBAAwB,WAAW,CAAA;AAC7D,EAAA,MAAM,UAAU,UAAW,CAAA;AAAA,IACzB,MAAA;AAAA,IACA,OAAA,CAAQ,GAAI,CAAA,iBAAA,CAAkB,MAAM,CAAA;AAAA,IACpC,GAAG,iBAAA;AAAA,IACH,GAAA,CAAI,IAAI,SAAS;AAAA,GAClB,CAAA;AACD,EAAA,OAAO,UAAU,OAAO,CAAA;AAC1B;AAEa,MAAA,uBAAA,GAA0B,CAAC,WACtC,KAAA,WAAA,CAAY,OAAQ,CAAA,IAAA,CAAK,CAAC,CAAA,EAAG,CAAM,KAAA;AACjC,EAAS,KAAA,IAAA,CAAA,GAAI,KAAK,CAAK,EAAA,EAAA;AACrB,IAAM,MAAA,KAAA,GAAQ,KAAK,CAAE,CAAA,MAAA;AACrB,IAAM,MAAA,KAAA,GAAQ,KAAK,CAAE,CAAA,MAAA;AAErB,IAAI,IAAA,KAAA,IAAS,OAAc,OAAA,CAAA;AAAA,SAAA,IAClB,OAAc,OAAA,EAAA;AAAA,SAAA,IACd,OAAc,OAAA,CAAA;AAAA,SAAA,IACd,CAAE,CAAA,CAAC,CAAM,KAAA,CAAA,CAAE,CAAC,CAAA,EAAU,OAAA,CAAA,CAAE,CAAC,CAAA,GAAI,CAAE,CAAA,CAAC,IAAI,CAAI,GAAA,EAAA;AAAA;AAErD,CAAC;;;;"}